# Apsidyne-Snippets
# 入力支援　スニペット　置換ツール　(Apsidyne Snippets Tool)
![version](https://img.shields.io/badge/version-2.0.0-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

## 概要 (Overview)
Apsidyne Snippets Tool は、主に不動産情報の入稿業務を支援するために設計された、Google Chrome拡張機能です。ユーザーのキー入力を監視し、事前に登録されたキーワードを検知すると、即座に定型文へと置換・DOM展開を行います。

設計思想として「ローカル完結」を掲げ、機密性の高いデータを扱う現場でも安心して利用できる堅牢なアーキテクチャを採用しています。

## 主な機能 (Features)

* リアルタイム・キーワード置換: 
キー入力を監視し、登録されたショートカットキーワードを自動的に展開します。
* サイト別動作設定: 
意図しないサイトでの誤作動を防ぐため、動作対象となるURL（ドメイン）をユーザーが指定できます。
* HTMLスニペット対応 & サニタイズ: 
単なるテキストだけでなく、装飾を含むHTMLタグの展開が可能です。ただし、セキュリティ確保のため、ホワイトリスト方式による厳格なサニタイズ処理を経てDOM操作を行います。
* 完全ローカルデータ管理: 
登録データはブラウザの localStorage にのみ保存されます。外部サーバーへの送信は一切行いません。
* データのインポート／エクスポート: 
登録データはJSON形式でバックアップ、またはチーム間での共有が可能です。
* デバッグモード: 詳細なログ出力を有効化し、トラブルシューティングを容易にします。

## セキュリティとプライバシー (Security & Privacy)
本ツールは、業務利用を前提に以下のセキュリティ対策を実装しています。
* 外部通信の遮断:
ユーザーが登録したスニペットデータ、および入力内容は一切外部サーバーへ送信されません。すべての処理はブラウザ内で完結します。
* 厳格なHTMLサニタイズ:
スニペットとして登録されたHTML文字列は、DOMへ展開される前にサニタイズ処理が行われます。<script>, <iframe>, object 等の危険なタグや、on* 系のイベントハンドラ属性はホワイトリスト方式で除外され、クロスサイトスクリプティング（XSS）攻撃を防止します。


## インストールと設定 (Installation & Configuration)
1. 動作サイトの設定拡張機能をインストール後、オプション画面より「動作対象サイト」を設定してください。空白の状態、どのサイトでも動作します。利用する不動産入稿システムのURL（例: suumo.jp, kensakun.net）等を追加してください。
2. デバッグモード (Debug Mode)動作が不安定な場合や、置換が意図通りに行われない場合は、オプション設定で「デバッグモード」を ON にしてください。Chromeの「デベロッパーツール (F12)」 > 「Console」タブに、詳細な処理ログが出力されます。

## 使い方 (Usage)
1. スニペットの登録ポップアップメニュー、またはオプション画面からスニペットを登録します。項目説明キーワード置換のトリガーとなる文字列 (例: ldk)置換内容展開される文字列またはHTML 説明管理用のメモなど。
2. 登録後は、目的のサイトの入力欄でキーワードを入力して、「；」キー押下で変換されます。
3. IME日本語入力中は、置換動作は停止しています。動作中に意図せずに変換が発火してしまった場合は、　CTRL＋Z で変換前の入力状態に戻れます。

## インポート／エクスポート (Import / Export)
設定画面より、登録済みスニペットをJSONファイルとして書き出し（エクスポート）、読み込み（インポート）が可能です。
JSONフォーマット例:
JSON[
  {
    "keyword": ";2ldk",
    "content": "<b>2LDK</b>（リビング12畳以上）",
    "description": "2LDK強調表示"
  },
  {
    "keyword": ";contact",
    "content": "担当：天本<br>電話：03-xxxx-xxxx",
    "description": "担当者署名"
  }
]

## 技術仕様 (Technical Specifications)
1. Storage: chrome.storage.local (User settings & Snippets)
2. Permissions:
   * storage: 設定およびスニペット保存のため
   * activeTab: 現在のタブでのDOM操作のため
   * scripting: 入力監視スクリプト動作のため
3. Supported Tags (Whitelist): 
   * 'b', 'strong', 'i', 'em', 'u', 'font', 'br', 'p', 'span', 'div',
   * 'color', 'size', 'face', 'style', 'class',


## 免責事項 (Disclaimer)
本ツールは入力支援を目的としており、入力内容の正確性を保証するものではありません。入稿データの入力後は、必ず目視での確認を行ってください。

## 更新履歴 (Changelog)
* v1.0.0: 初回リリース。基本機能（キーワード置換、ローカル保存、インポート/エクスポート）の実装。
* v2.0.0: 使用サイト指定を追加。Date Format追加変更があり　version 2 とする。

## Author
@author Apsidyne+ext2025[at]gmail.com since 2025
